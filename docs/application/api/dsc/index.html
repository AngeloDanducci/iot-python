<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Data Store Connectors - IBM Watson IoT Platform</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Store Connectors";
    var mkdocs_page_input_path = "application\\api\\dsc.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> IBM Watson IoT Platform</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Python SDK</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Common Topics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../concepts/">Basic Concepts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mqtt/">MQTT Primer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../custommsg/">Custom Message Formats</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../exceptions/">Exceptions</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Application Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../">Application SDK</a>
                </li>
                <li class="">
                    
    <a class="" href="../../config/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mqtt/commands/">Device Commands</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mqtt/events/">Device Events</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mqtt/status/">Device Status Updates</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Data Store Connectors</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#data-store-connectors">Data Store Connectors</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#service-bindings">Service Bindings</a></li>
        
            <li><a class="toctree-l4" href="#connectors">Connectors</a></li>
        
            <li><a class="toctree-l4" href="#destinations">Destinations</a></li>
        
            <li><a class="toctree-l4" href="#forwarding-rules">Forwarding Rules</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../registry/types/">Registry - Types</a>
                </li>
                <li class="">
                    
    <a class="" href="../registry/devices/">Registry - Devices</a>
                </li>
                <li class="">
                    
    <a class="" href="../registry/diag/">Registry - Diagnostics</a>
                </li>
                <li class="">
                    
    <a class="" href="../mgmt/">Device Management</a>
                </li>
                <li class="">
                    
    <a class="" href="../lec/">Last Event Cache</a>
                </li>
                <li class="">
                    
    <a class="" href="../status/">Service Status</a>
                </li>
                <li class="">
                    
    <a class="" href="../usage/">Usage Reports</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Device Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../device/">Device SDK</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../device/config/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../device/managed/">Managed Devices</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Gateway Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../gateway/">Gateway SDK</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../gateway/config/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../gateway/managed/">Managed Gateways</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">IBM Watson IoT Platform</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Application Development &raquo;</li>
        
      
    
    <li>Data Store Connectors</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="data-store-connectors">Data Store Connectors<a class="headerlink" href="#data-store-connectors" title="Permanent link"></a></h1>
<ul>
<li>You can have multiple connectors (up to 10, depending on your service plan) of mixed types (cloudant/eventstreams). This means 6 combined, not 6 of each.</li>
<li>Each connector can have multiple destinations and forwarding rules defined (up to 100 of each, depending on your service plan) </li>
<li>Each forwarding rule can only route to a single destination, but multiple rules can reference the same destination</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don't use this yet, there is a bug in the DSC API paging code, that this client library exposed which would result in an infinite loop in your code if you use the <code>dsc</code>, or <code>dsc[connectorId].rules</code> iterators</p>
</div>
<pre><code class="python">import wiotp.sdk.application

options = wiotp.sdk.application.parseEnvVars()
appClient = wiotp.sdk.application.ApplicationClient(options)

serviceBinding = {
    &quot;name&quot;: &quot;test-cloudant&quot;,  &quot;description&quot;: &quot;Test Cloudant instance&quot;, &quot;type&quot;: &quot;cloudant&quot;, 
    &quot;credentials&quot;: { &quot;host&quot;: &quot;hostname&quot;, &quot;port&quot;: 443, &quot;username&quot;: &quot;username&quot;, &quot;password&quot;: &quot;password&quot; }
}

cloudantService = appClient.serviceBindings.create(serviceBinding)

# Create the connector
connector = self.appClient.dsc.create(
    name=&quot;connector1&quot;, serviceId=createdService.id, timezone=&quot;UTC&quot;, description=&quot;A test connector&quot;, enabled=True
)

# Create a destination under the connector
destination1 = createdConnector.destinations.create(name=&quot;all-data&quot;, bucketInterval=&quot;DAY&quot;)

# Create a rule under the connector, that routes all events to the destination
rule1 = createdConnector.rules.createEventRule(
    name=&quot;allevents&quot;, destinationName=destination1.name, description=&quot;Send all events&quot;, enabled=True, typeId=&quot;*&quot;, eventId=&quot;*&quot;
)
# Create a second rule under the connector, that routes all state to the same destination
rule2 = createdConnector.rules.createStateRule(
    name=&quot;allstate&quot;, destinationName=destination1.name, description=&quot;Send all state&quot;, enabled=True, logicalInterfaceId=&quot;*&quot;
)
</code></pre>

<h2 id="service-bindings">Service Bindings<a class="headerlink" href="#service-bindings" title="Permanent link"></a></h2>
<p>Service bindings can be established with Cloudant and EventStreams:</p>
<pre><code class="python">import wiotp.sdk.application

options = wiotp.sdk.application.parseEnvVars()
appClient = wiotp.sdk.application.ApplicationClient(options)

serviceBinding = {
    &quot;name&quot;: &quot;test-cloudant&quot;, 
    &quot;description&quot;: &quot;Test Cloudant instance&quot;,
    &quot;type&quot;: &quot;cloudant&quot;, 
    &quot;credentials&quot;: {
        &quot;host&quot;: &quot;hostname&quot;,
        &quot;port&quot;: 443,
        &quot;username&quot;: &quot;username&quot;,
        &quot;password&quot;: &quot;password
    }
}

cloudantService = appClient.serviceBindings.create(serviceBinding)

serviceBinding = {
    &quot;name&quot;: &quot;test-eventstreams&quot;, 
    &quot;description&quot;: &quot;Test EventStreams instance&quot;,
    &quot;type&quot;: &quot;eventstreams&quot;, 
    &quot;credentials&quot;: {
        &quot;api_key&quot;: &quot;myapikey&quot;,
        &quot;user&quot;: &quot;myusername,
        &quot;password&quot;: &quot;mypassword&quot;,
        &quot;kafka_admin_url&quot;: &quot;myurl&quot;,
        &quot;kafka_brokers_sasl&quot;: [ &quot;broker1&quot;, &quot;broker2&quot;, &quot;broker3&quot;, &quot;broker4&quot;, &quot;broker5&quot; ]
    }
}

eventstreamsService = appClient.serviceBindings.create(serviceBinding)
</code></pre>

<p>Finding service bindings</p>
<pre><code class="python">import wiotp.sdk.application

options = wiotp.sdk.application.parseEnvVars()
appClient = wiotp.sdk.application.ApplicationClient(options)

# Iterate through all service bindings
for s in appClient.serviceBindings:
    print(s.name)
    print(&quot; - &quot; + s.description)
    print(&quot; - &quot; + s.type)
    print()

print()

# Iterate through service bindings of type &quot;cloudant&quot;
for s in appClient.serviceBindings.find(typeFilter=&quot;cloudant&quot;):
    print(s.name)
    print(&quot; - &quot; + s.description)
    print(&quot; - &quot; + s.type)
    print()
</code></pre>

<h2 id="connectors">Connectors<a class="headerlink" href="#connectors" title="Permanent link"></a></h2>
<pre><code class="python">import wiotp.sdk.application

options = wiotp.sdk.application.parseEnvVars()
appClient = wiotp.sdk.application.ApplicationClient(options)

# Create the connector
serviceId = &quot;xxx&quot;
connector = appClient.dsc.create(
    name=&quot;test-connector-cloudant&quot;, serviceId=serviceId, timezone=&quot;UTC&quot;, description=&quot;A test connector&quot;, enabled=True
)

print(&quot; - &quot; + connector.name)
print(&quot; - &quot; + connector.connectorType)
print(&quot; - Enabled: &quot; + connector.enabled)
</code></pre>

<h2 id="destinations">Destinations<a class="headerlink" href="#destinations" title="Permanent link"></a></h2>
<pre><code class="python">import wiotp.sdk.application

options = wiotp.sdk.application.parseEnvVars()
appClient = wiotp.sdk.application.ApplicationClient(options)

connectorId = &quot;xxx&quot;
connector = appClient.dsc[connectorId]

# Create a destination under the connector
destination1 = connector.destinations.create(name=destinationName, bucketInterval=&quot;DAY&quot;)

</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Destinations are immutable.  If you want to change where you send events to:</p>
<ul>
<li>Create a new destination</li>
<li>Update the forwarding rule to reference the new destination</li>
<li>Delete the old destination</li>
</ul>
</div>
<h2 id="forwarding-rules">Forwarding Rules<a class="headerlink" href="#forwarding-rules" title="Permanent link"></a></h2>
<pre><code class="python">import wiotp.sdk.application

options = wiotp.sdk.application.parseEnvVars()
appClient = wiotp.sdk.application.ApplicationClient(options)

# Note: This code assumes a destination named &quot;all-data&quot; has already been created under this connector
connectorId = &quot;xxx&quot;
connector = appClient.dsc[connectorId]

# Create a rule under the connector, that routes all events to the destination
rule1 = connector.rules.createEventRule(
    name=&quot;allevents&quot;, 
    destinationName=&quot;all-data&quot;, 
    description=&quot;Send all events&quot;, 
    enabled=True, 
    typeId=&quot;*&quot;, 
    eventId=&quot;*&quot;
)

# Create a second rule under the connector, that routes all state to the same destination
rule2 = createdConnector.rules.createStateRule(
    name=&quot;allstate&quot;, 
    destinationName=&quot;all-data&quot;, 
    description=&quot;Send all state&quot;, 
    enabled=True, 
    logicalInterfaceId=&quot;*&quot;
)
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Two different rules can forward to the same destination, but if you want to forward the same content to two different destinations you would create two forwarding rules with the same configuration, each referencing a different destination.</p>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../registry/types/" class="btn btn-neutral float-right" title="Registry - Types">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../mqtt/status/" class="btn btn-neutral" title="Device Status Updates"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../mqtt/status/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../registry/types/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
